(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(t){if(t.ep)return;t.ep=!0;const s=i(t);fetch(t.href,s)}})();document.addEventListener("DOMContentLoaded",()=>{const d=document.getElementById("search-input"),a=document.getElementById("search-btn"),i=document.getElementById("results"),o=document.getElementById("book-details");a.addEventListener("click",t),d.addEventListener("keypress",e=>{e.key==="Enter"&&t()});async function t(){const e=d.value.trim();if(e)try{const n=await(await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(e)}`)).json();s(n.docs)}catch(r){console.error("Error fetching books:",r),i.innerHTML="<p>Error loading books. Please try again.</p>"}}function s(e){if(i.innerHTML="",o.classList.add("hidden"),!e||e.length===0){i.innerHTML="<p>No books found. Try another search.</p>";return}e.slice(0,12).forEach(r=>{const n=document.createElement("div");n.className="book-card",n.innerHTML=`
        <h3>${r.title}</h3>
        ${r.author_name?`<p>by ${r.author_name.join(", ")}</p>`:""}
        ${r.first_publish_year?`<p>First published: ${r.first_publish_year}</p>`:""}
      `,r.cover_i?n.innerHTML+=`<img src="https://covers.openlibrary.org/b/id/${r.cover_i}-M.jpg" alt="${r.title} cover">`:n.innerHTML+='<div class="no-cover">No cover available</div>',n.addEventListener("click",()=>l(r)),i.appendChild(n)})}async function l(e){i.classList.add("hidden"),o.classList.remove("hidden");let r=`
      <button class="back-btn" id="back-btn">Back to results</button>
      <h2>${e.title}</h2>
      ${e.author_name?`<p><strong>Author(s):</strong> ${e.author_name.join(", ")}</p>`:""}
      ${e.first_publish_year?`<p><strong>First published:</strong> ${e.first_publish_year}</p>`:""}
      ${e.publisher?`<p><strong>Publisher(s):</strong> ${Array.isArray(e.publisher)?e.publisher.join(", "):e.publisher}</p>`:""}
    `;if(e.cover_i&&(r+=`<img src="https://covers.openlibrary.org/b/id/${e.cover_i}-L.jpg" alt="${e.title} cover" style="max-width: 200px; float: left; margin-right: 20px; margin-bottom: 20px;">`),e.key)try{const c=await(await fetch(`https://openlibrary.org${e.key}.json`)).json();if(c.description){const p=typeof c.description=="string"?c.description:c.description.value||"No description available";r+=`<p><strong>Description:</strong> ${p}</p>`}c.subjects&&(r+=`<p><strong>Subjects:</strong> ${c.subjects.join(", ")}</p>`)}catch(n){console.error("Error fetching book details:",n)}o.innerHTML=r,document.getElementById("back-btn").addEventListener("click",()=>{i.classList.remove("hidden"),o.classList.add("hidden")})}});
